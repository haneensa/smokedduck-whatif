import smokedduck
from scorpion import runscorpion


sql = "SELECT hrint AS hrint, stddev(temp) AS temp FROM readings AS readings GROUP BY hrint"
aggid = 0
goodids = [192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222]
badids = [253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295]

goodids = [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193]
badids = [252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294 , 295] 



badids = [125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136]
goodids = [238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280 , 281, 282]                  
badvals = [24.490595763833788, 24.275260982048554, 24.106165281045723, 23.844844852191695, 23.809694632698445, 23.495455511498825, 23.231177668138145, 23.337014150702604, 23.349551748606277, 25.012635386965375, 25.39157573585863, 25.338682141955033, 25.347098738738715, 25.438294297915153, 25.845177284073795, 26.844151063284613, 25.970862408850973, 25.25903819655516, 24.868411402392464, 24.01369950544013, 25.193172148916037, 25.483557397737247, 25.05784034353668, 24.74868295528202, 24.897643799234896, 24.60384824833698, 24.68957087033743, 24.394997300884956, 23.872872973583004, 23.86895712014532, 23.75798882827857, 23.678341422048508, 23.59187634220865, 25.397121828571407, 25.666169635805197, 25.349181473684197, 24.876560533333343, 25.149950467539355, 25.64543259417586, 25.77017898832691, 25.624871216931183, 25.424138208032968, 24.92412257720976, 24.28206, 23.534776920943163]
goodvals = [17.398417915904883, 17.25683707214327, 23.022547710023566, 25.16922926702929, 25.42545940594059, 25.30349353049902, 25.807720512820506, 26.181229012023014, 26.152762150982408, 24.5970389412064, 23.791703834196824, 22.92067508896804]                   

goodids = [177, 178, 179, 180, 181, 182, 183]
badids = [250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300]
badvals = [15.16892633118976, 14.494715947250503, 15.218898489570396, 15.85434936957489, 15.58903827499417, 15.104080678655095, 15.230142000909037, 15.202570593458596, 14.935992005525096, 14.867605271676123, 14.206691613297613, 14.190309410659363, 14.92172664399193, 14.322487451908401, 14.996116439333594, 15.305187829127949, 14.870884414740454, 15.069196006766779, 15.003148768485925, 14.914480388043899, 14.503906846257323, 14.99579145850937, 14.236885714381861, 10.631367389377814, 5.933271814685419, 7.4926987617976835, 8.16082572547585, 8.209433835280171, 6.58538643650889, 7.339160472198813, 7.614307409371628, 8.070311958376452, 11.472046042209906, 15.482284672542725, 15.307003409800341, 15.580569816643425, 15.803217048330469, 15.821439406049699, 16.07248429885535, 15.569602280101364, 15.66941938121666, 16.383995324945143, 15.75162444714894, 16.074519591089942, 16.291660213759712, 16.361653222519962, 14.936664147158018, 16.634111054579133, 16.65695722253812, 16.360778951877617, 15.20083374231353]
goodvals = [2.0906440689561396, 2.4038032833689593, 2.5845578016293906, 2.5903622064266383, 2.264315914370518, 1.7895817788088295, 1.6982203652334917]

with smokedduck.connect("intel.db") as con:
    o = runscorpion(con, sql, aggid, goodids, badids, goodvals, badvals)
    for r in o['results']:
        print(r['score'])
        print(r['clauses'])
